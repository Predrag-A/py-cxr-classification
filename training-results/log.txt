PS D:\Repos\python workspace\cxr-data-classification> python scripts/train_classifier.py -t cxr-data/train -v cxr-data/validation -o model.h5

WARNING:tensorflow:From C:\Programming\Python-3.7.0\lib\site-packages\keras\backend\tensorflow_backend.py:4070: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

2019-09-30 17:28:03.852415: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
2019-09-30 17:28:03.861037: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library nvcuda.dll
2019-09-30 17:28:04.069623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: GeForce GTX 1070 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.683
pciBusID: 0000:09:00.0
2019-09-30 17:28:04.076946: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.
2019-09-30 17:28:04.083668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2019-09-30 17:28:04.988211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-09-30 17:28:04.992250: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2019-09-30 17:28:04.995427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2019-09-30 17:28:04.999221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6363 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070 Ti, pci bus id: 0000:09:00.0, compute capability: 6.1)
WARNING:tensorflow:From C:\Programming\Python-3.7.0\lib\site-packages\keras\backend\tensorflow_backend.py:4074: The name tf.nn.avg_pool is deprecated. Please use tf.nn.avg_pool2d instead.

Model: "ResNet50"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 448, 448, 1)  0
__________________________________________________________________________________________________
zero_padding2d_1 (ZeroPadding2D (None, 454, 454, 1)  0           input_1[0][0]
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 224, 224, 64) 3200        zero_padding2d_1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 112, 112, 64) 0           conv1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, 112, 112, 64) 4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (BatchNormalizati (None, 112, 112, 64) 256         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, 112, 112, 64) 36928       activation_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (BatchNormalizati (None, 112, 112, 64) 256         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 112, 112, 64) 0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, 112, 112, 256 16640       activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (BatchNormalizati (None, 112, 112, 256 1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
res2a_branch10 (Conv2D)         (None, 112, 112, 256 16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 112, 112, 256 0           bn2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (BatchNormalizatio (None, 112, 112, 256 1024        res2a_branch10[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, 112, 112, 256 0           activation_3[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 112, 112, 256 0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, 112, 112, 64) 16448       activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (BatchNormalizati (None, 112, 112, 64) 256         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 112, 112, 64) 0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, 112, 112, 64) 36928       activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (BatchNormalizati (None, 112, 112, 64) 256         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 112, 112, 64) 0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, 112, 112, 256 16640       activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (BatchNormalizati (None, 112, 112, 256 1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, 112, 112, 256 0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 112, 112, 256 0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, 112, 112, 64) 16448       activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (BatchNormalizati (None, 112, 112, 64) 256         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 112, 112, 64) 0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, 112, 112, 64) 36928       activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (BatchNormalizati (None, 112, 112, 64) 256         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 112, 112, 64) 0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, 112, 112, 256 16640       activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (BatchNormalizati (None, 112, 112, 256 1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, 112, 112, 256 0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 112, 112, 256 0           add_3[0][0]
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 56, 56, 256)  0           activation_10[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, 28, 28, 128)  32896       max_pooling2d_2[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 128)  0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, 28, 28, 128)  147584      activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (BatchNormalizati (None, 28, 28, 128)  512         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 128)  0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, 28, 28, 512)  66048       activation_12[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
res3a_branch10 (Conv2D)         (None, 28, 28, 512)  131584      max_pooling2d_2[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           bn3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (BatchNormalizatio (None, 28, 28, 512)  2048        res3a_branch10[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           activation_13[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 128)  0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, 28, 28, 128)  147584      activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (BatchNormalizati (None, 28, 28, 128)  512         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 128)  0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, 28, 28, 512)  66048       activation_16[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           bn3b_branch2c[0][0]
                                                                 activation_14[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, 28, 28, 128)  65664       activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 128)  0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, 28, 28, 128)  147584      activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (BatchNormalizati (None, 28, 28, 128)  512         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 128)  0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, 28, 28, 512)  66048       activation_19[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (BatchNormalizati (None, 28, 28, 512)  2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           bn3c_branch2c[0][0]
                                                                 activation_17[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, 14, 14, 256)  131328      activation_20[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 14, 14, 256)  0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_21[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 14, 14, 256)  0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
res4a_branch10 (Conv2D)         (None, 14, 14, 1024) 525312      activation_20[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 1024) 0           bn4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (BatchNormalizatio (None, 14, 14, 1024) 4096        res4a_branch10[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, 14, 14, 1024) 0           activation_23[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 1024) 0           add_7[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_24[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 256)  0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 256)  0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           bn4b_branch2c[0][0]
                                                                 activation_24[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_27[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 256)  0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 256)  0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           bn4c_branch2c[0][0]
                                                                 activation_27[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 1024) 0           add_9[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_30[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 256)  0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 256)  0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           bn4d_branch2c[0][0]
                                                                 activation_30[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 1024) 0           add_10[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, 14, 14, 256)  262400      activation_33[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 256)  0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, 14, 14, 256)  590080      activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (BatchNormalizati (None, 14, 14, 256)  1024        res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 256)  0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, 14, 14, 1024) 263168      activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (BatchNormalizati (None, 14, 14, 1024) 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           bn4e_branch2c[0][0]
                                                                 activation_33[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 1024) 0           add_11[0][0]
__________________________________________________________________________________________________
res5a_branch2a (Conv2D)         (None, 7, 7, 512)    524800      activation_36[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 7, 7, 512)    0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (Conv2D)         (None, 7, 7, 512)    2359808     activation_37[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (BatchNormalizati (None, 7, 7, 512)    2048        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 7, 7, 512)    0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (Conv2D)         (None, 7, 7, 2048)   1050624     activation_38[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
res5a_branch10 (Conv2D)         (None, 7, 7, 2048)   2099200     activation_36[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 7, 7, 2048)   0           bn5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (BatchNormalizatio (None, 7, 7, 2048)   8192        res5a_branch10[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, 7, 7, 2048)   0           activation_39[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 7, 7, 2048)   0           add_12[0][0]
__________________________________________________________________________________________________
res5b_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_40[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 512)    0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (Conv2D)         (None, 7, 7, 512)    2359808     activation_41[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (BatchNormalizati (None, 7, 7, 512)    2048        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 512)    0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (Conv2D)         (None, 7, 7, 2048)   1050624     activation_42[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, 7, 7, 2048)   0           bn5b_branch2c[0][0]
                                                                 activation_40[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 2048)   0           add_13[0][0]
__________________________________________________________________________________________________
res5c_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_43[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 512)    0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (Conv2D)         (None, 7, 7, 512)    2359808     activation_44[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (BatchNormalizati (None, 7, 7, 512)    2048        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 512)    0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (Conv2D)         (None, 7, 7, 2048)   1050624     activation_45[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           bn5c_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]
__________________________________________________________________________________________________
res5d_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_46[0][0]
__________________________________________________________________________________________________
bn5d_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5d_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 512)    0           bn5d_branch2a[0][0]
__________________________________________________________________________________________________
res5d_branch2b (Conv2D)         (None, 7, 7, 512)    2359808     activation_47[0][0]
__________________________________________________________________________________________________
bn5d_branch2b (BatchNormalizati (None, 7, 7, 512)    2048        res5d_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 512)    0           bn5d_branch2b[0][0]
__________________________________________________________________________________________________
res5d_branch2c (Conv2D)         (None, 7, 7, 2048)   1050624     activation_48[0][0]
__________________________________________________________________________________________________
bn5d_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5d_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           bn5d_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 2048)   0           add_15[0][0]
__________________________________________________________________________________________________
res5e_branch2a (Conv2D)         (None, 7, 7, 512)    1049088     activation_49[0][0]
__________________________________________________________________________________________________
bn5e_branch2a (BatchNormalizati (None, 7, 7, 512)    2048        res5e_branch2a[0][0]
__________________________________________________________________________________________________
activation_50 (Activation)      (None, 7, 7, 512)    0           bn5e_branch2a[0][0]
__________________________________________________________________________________________________
res5e_branch2b (Conv2D)         (None, 7, 7, 512)    2359808     activation_50[0][0]
__________________________________________________________________________________________________
bn5e_branch2b (BatchNormalizati (None, 7, 7, 512)    2048        res5e_branch2b[0][0]
__________________________________________________________________________________________________
activation_51 (Activation)      (None, 7, 7, 512)    0           bn5e_branch2b[0][0]
__________________________________________________________________________________________________
res5e_branch2c (Conv2D)         (None, 7, 7, 2048)   1050624     activation_51[0][0]
__________________________________________________________________________________________________
bn5e_branch2c (BatchNormalizati (None, 7, 7, 2048)   8192        res5e_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           bn5e_branch2c[0][0]
                                                                 activation_49[0][0]
__________________________________________________________________________________________________
activation_52 (Activation)      (None, 7, 7, 2048)   0           add_16[0][0]
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 1, 1, 2048)   0           activation_52[0][0]
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           average_pooling2d_1[0][0]
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 3)            0
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 2051)         0           flatten_1[0][0]
                                                                 input_2[0][0]
__________________________________________________________________________________________________
fc15 (Dense)                    (None, 15)           30780       concatenate_1[0][0]
==================================================================================================
Total params: 31,151,420
Trainable params: 31,090,748
Non-trainable params: 60,672
__________________________________________________________________________________________________
WARNING:tensorflow:From C:\Programming\Python-3.7.0\lib\site-packages\keras\backend\tensorflow_backend.py:422: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.

Epoch 1/50
14015/14015 [==============================] - 4302s 307ms/step - loss: 1.7708 - accuracy: 0.5297
Epoch 2/50
14015/14015 [==============================] - 3717s 265ms/step - loss: 1.6784 - accuracy: 0.5380
Epoch 3/50
14015/14015 [==============================] - 3543s 253ms/step - loss: 1.6217 - accuracy: 0.5356
Epoch 4/50
14015/14015 [==============================] - 3528s 252ms/step - loss: 1.5903 - accuracy: 0.5379
Epoch 5/50
14015/14015 [==============================] - 3445s 246ms/step - loss: 1.5645 - accuracy: 0.5399
Epoch 6/50
14015/14015 [==============================] - 3505s 250ms/step - loss: 1.5431 - accuracy: 0.5435
Epoch 7/50
14015/14015 [==============================] - 3369s 240ms/step - loss: 1.5226 - accuracy: 0.5457
Epoch 8/50
14015/14015 [==============================] - 3371s 241ms/step - loss: 1.5058 - accuracy: 0.5471
Epoch 9/50
14015/14015 [==============================] - 3369s 240ms/step - loss: 1.4880 - accuracy: 0.5505
Epoch 10/50
14015/14015 [==============================] - 3378s 241ms/step - loss: 1.4702 - accuracy: 0.5518
Epoch 11/50
14015/14015 [==============================] - 3377s 241ms/step - loss: 1.4511 - accuracy: 0.5553
Epoch 12/50
14015/14015 [==============================] - 3376s 241ms/step - loss: 1.4289 - accuracy: 0.5593
Epoch 13/50
14015/14015 [==============================] - 3365s 240ms/step - loss: 1.4039 - accuracy: 0.5648
Epoch 14/50
14015/14015 [==============================] - 3378s 241ms/step - loss: 1.3725 - accuracy: 0.5707
Epoch 15/50
14015/14015 [==============================] - 3375s 241ms/step - loss: 1.3302 - accuracy: 0.5805
Epoch 16/50
14015/14015 [==============================] - 3370s 240ms/step - loss: 1.2753 - accuracy: 0.5939
Epoch 17/50
14015/14015 [==============================] - 3365s 240ms/step - loss: 1.1979 - accuracy: 0.6132
Epoch 18/50
14015/14015 [==============================] - 3351s 239ms/step - loss: 1.0978 - accuracy: 0.6422
Epoch 19/50
14015/14015 [==============================] - 3369s 240ms/step - loss: 0.9700 - accuracy: 0.6778
Epoch 20/50
14015/14015 [==============================] - 3364s 240ms/step - loss: 0.8209 - accuracy: 0.7255
Epoch 21/50
14015/14015 [==============================] - 9163s 654ms/step - loss: 0.6644 - accuracy: 0.7760
Epoch 22/50
14015/14015 [==============================] - 3365s 240ms/step - loss: 0.5230 - accuracy: 0.8227
Epoch 23/50
14015/14015 [==============================] - 3385s 242ms/step - loss: 0.4069 - accuracy: 0.8605
Epoch 24/50
14015/14015 [==============================] - 3377s 241ms/step - loss: 0.3273 - accuracy: 0.8904
Epoch 25/50
14015/14015 [==============================] - 3456s 247ms/step - loss: 0.2733 - accuracy: 0.9068
Epoch 26/50
14015/14015 [==============================] - 3531s 252ms/step - loss: 0.2347 - accuracy: 0.9208
Epoch 27/50
14015/14015 [==============================] - 3457s 247ms/step - loss: 0.2049 - accuracy: 0.9311
Epoch 28/50
14015/14015 [==============================] - 3467s 247ms/step - loss: 0.1847 - accuracy: 0.9375
Epoch 29/50
14015/14015 [==============================] - 3459s 247ms/step - loss: 0.1685 - accuracy: 0.9427
Epoch 30/50
14015/14015 [==============================] - 3394s 242ms/step - loss: 0.1568 - accuracy: 0.9469
Epoch 31/50
14015/14015 [==============================] - 3377s 241ms/step - loss: 0.1453 - accuracy: 0.9507
Epoch 32/50
14015/14015 [==============================] - 3374s 241ms/step - loss: 0.1378 - accuracy: 0.9526
Epoch 33/50
14015/14015 [==============================] - 3381s 241ms/step - loss: 0.1286 - accuracy: 0.9565
Epoch 34/50
14015/14015 [==============================] - 3383s 241ms/step - loss: 0.1231 - accuracy: 0.9586
Epoch 35/50
14015/14015 [==============================] - 3377s 241ms/step - loss: 0.1146 - accuracy: 0.9618
Epoch 36/50
14015/14015 [==============================] - 3375s 241ms/step - loss: 0.1122 - accuracy: 0.9618
Epoch 37/50
14015/14015 [==============================] - 3379s 241ms/step - loss: 0.1071 - accuracy: 0.9637
Epoch 38/50
14015/14015 [==============================] - 3372s 241ms/step - loss: 0.1018 - accuracy: 0.9652
Epoch 39/50
14015/14015 [==============================] - 3376s 241ms/step - loss: 0.0972 - accuracy: 0.9667
Epoch 40/50
14015/14015 [==============================] - 3379s 241ms/step - loss: 0.0951 - accuracy: 0.9679
Epoch 41/50
14015/14015 [==============================] - 3384s 241ms/step - loss: 0.0926 - accuracy: 0.9686
Epoch 42/50
14015/14015 [==============================] - 3385s 241ms/step - loss: 0.0873 - accuracy: 0.9703
Epoch 43/50
14015/14015 [==============================] - 3373s 241ms/step - loss: 0.0846 - accuracy: 0.9704
Epoch 44/50
14015/14015 [==============================] - 3386s 242ms/step - loss: 0.0814 - accuracy: 0.9723
Epoch 45/50
14015/14015 [==============================] - 3390s 242ms/step - loss: 0.0796 - accuracy: 0.9726
Epoch 46/50
14015/14015 [==============================] - 3387s 242ms/step - loss: 0.0790 - accuracy: 0.9728
Epoch 47/50
14015/14015 [==============================] - 3385s 242ms/step - loss: 0.0748 - accuracy: 0.9748
Epoch 48/50
14015/14015 [==============================] - 3405s 243ms/step - loss: 0.0755 - accuracy: 0.9745
Epoch 49/50
14015/14015 [==============================] - 3661s 261ms/step - loss: 0.0733 - accuracy: 0.9749
Epoch 50/50
14015/14015 [==============================] - 3521s 251ms/step - loss: 0.0701 - accuracy: 0.9760







